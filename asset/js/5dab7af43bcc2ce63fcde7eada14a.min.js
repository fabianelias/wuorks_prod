  /*******************************************************************************
 * 
 *        Funciones google Maps
 *        Copyright © 2016 wuorks.com Todos los Derechos Reservados.
 *        v1.0
 *        
 ******************************************************************************/

function fn_error(){divSearchMap=$("#map-search").html("<center>Lo sentimos, ha ocurrido un error intentalo nuevamente.<br/>Si el problema persiste contactanos a contacto@beta.wuorks.com</center>")}function initialize(e){lon=e.coords.longitude,lat=e.coords.latitude;var a=new google.maps.LatLng(lat,lon),s={zoom:12,center:a,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP}};map=new google.maps.Map(document.getElementById("map-search"),s);var o={position:a,map:map,title:"Mi posición actual"};new google.maps.Marker(o);createMarkers()}function createMarkers(){var e=(new google.maps.InfoWindow,$("#url_base").val()),a=$("#wuorks").val(),s=$("#region").val();$.ajax({url:e+"search/result",type:"post",data:{region:s,wuork_area:a},dataType:"json",success:function(a){if(""!=a.res){var s=0;$.each(a.res,function(a,o){function t(a){var s=a[0].geometry.location,t={map:map,position:s,title:o.username},r=new google.maps.Marker(t);r.setIcon(e+"asset/img/marker2.png");var i={content:'<div class="thumbnail" style="padding: 0px;"><img src="'+e+"asset/img/user_avatar/"+o.avatar+'" alt="..." style="margin: 0 auto;"><div class="caption"><h3 id="nameUser">'+o.username+'</h3><p><a href="#" class="btn btn-default btn-block" role="button">ver perfil</a><a href="#" class="btn btn-primary btn-block" data-dismiss="modal"  role="button">Cerrar</a></p> </div></div>'};new google.maps.InfoWindow(i);google.maps.event.addListener(r,"click",function(){perfilUsuario(o),window.location.href="#cont"+o.wuorks_key});var n=lat+","+lon,l=o.address+", "+o.commune,m="",d="",p="";1==o.type?(p="Profesional",d="u"):(p="Empresa",d="c");var c=new google.maps.DistanceMatrixService;c.getDistanceMatrix({origins:[n],destinations:[l],travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC,avoidHighways:!1,avoidTolls:!1},function(a,s){s!=google.maps.DistanceMatrixStatus.OK?kms="":kms="<small class=''><i class='fa fa-map-marker'></i> a "+a.rows[0].elements[0].distance.text+" de ti.</small>".toString(),m+=kms;var t='<li class="topHover" id="cont'+o.wuorks_key+'"style="border-bottom:1px solid #eee;"><div class="media" style="margin-left:5px;padding:5px;padding-top:15px;margin-bottom: -10px;"> <div class="media-left"><a href="'+e+"wuokers/"+d+"/"+o.username+"/"+o.profession+"/"+o.key_profession+"?wk="+o.wuorks_key+'"><img class="media-object img-thumbnail thumbnail" src="'+e+"asset/img/user_avatar/"+o.avatar+'" alt="'+o.username+'" style="height:100px; max-width:100px;"> </a> </div> <div class="media-body"><a href="'+e+"wuokers/"+d+"/"+o.username+"/"+o.profession+"/"+o.key_profession+"?wk="+o.wuorks_key+'"><h4 class="media-heading username">'+o.username+"<small>/ "+p+"</small></h4></a>"+o.profession+".<br>"+m+'</div> <div class="media-left text-center text-info"><br/>&nbsp;<b class="username">'+o.rating+'</b> <br/>&nbsp;<i class="fa fa-star-o" aria-hidden="true"></i> <br/>&nbsp;<small>Calificación</small> </div></div></li>';$("#loadTop").addClass("hidden"),$("#topWuokers").append(t)})}var r={address:o.address},i=new google.maps.Geocoder;i.geocode(r,t),s++}),$("#ttUser").html(s+" wuokers cerca de ti <i class='fa fa-map-marker'></i>")}else $("#alert-search").removeClass("hidden"),$("#sinResultados").removeClass("hidden"),$("#loadTop").addClass("hidden"),$("#tops").removeClass("open")}})}function perfilUsuario(e){var a=$("#url_base").val(),s="";s=1==e.type?"u":"c",$("#userInfo").html('<div class="thumbnail" style="padding: 0px; border:0px; max-width:300px;"><img src="'+a+"asset/img/user_avatar/"+e.avatar+'" alt="Wuokers" style="margin: 0 auto;"><div class="caption text-center"><h3 id="nameUser" style="font-weight:300;">'+e.username+'<br/><small style="font-weight:300;">Profesión - '+e.profession+'<hr/></small></h3><p><form name="form-user" id="form-user" action="'+a+"wuokers/"+s+"/"+e.username+"/"+e.profession+"/"+e.key_profession+"?wk="+e.wuorks_key+'" method="POST" target="_blank"><input type="hidden" name="wuorks_key" id="wuorks_key" value="'+e.wuorks_key+'"><input type="hidden" name="key_profession" id="key_profession" value="'+e.key_profession+'"><button type="submit" name="verPerfil" style="width:47%;float:right;" class="btn btn-primary btn-block">Ver perfil</button></form><br/><a href="#" class="btn btn-default btn-block" data-dismiss="modal" style="width:47%;float:left;margin-top:-20px;" role="button">Cerrar</a></p> </div></div>'),$("#perfilUser").modal("show")}navigator.geolocation.getCurrentPosition(initialize,fn_error);var divSearchMap=document.getElementById("map-search"),map,lon="",lat="",miI="";
/*******************************************************************************
 * Nota*: Documento generado por wuorks.com, no se permite copia de un fragmento
 * del codigo o del todo.
 * v1.0.
 ******************************************************************************/
