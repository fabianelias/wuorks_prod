  /*******************************************************************************
 * 
 *        Funciones google Maps
 *        Copyright © 2016 wuorks.com Todos los Derechos Reservados.
 *        v1.0
 *        
 ******************************************************************************/

function fn_error(){divSearchMap=$("#map-search").html("<center>Lo sentimos, ha ocurrido un error intentalo nuevamente.<br/>Si el problema persiste contactanos a contacto@beta.wuorks.com</center>")}function initialize(a){lon=a.coords.longitude,lat=a.coords.latitude;var b=new google.maps.LatLng(lat,lon),c={zoom:12,center:b,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP}};map=new google.maps.Map(document.getElementById("map-search"),c);var d={position:b,map:map,title:"Mi posición actual"};new google.maps.Marker(d);createMarkers()}function createMarkers(){var g=(new google.maps.InfoWindow,$("#url_base").val()),h=$("#wuorks").val(),i=$("#region").val();$.ajax({url:g+"search/result",type:"post",data:{region:i,wuork_area:h},dataType:"json",success:function(a){if(""!=a.res){var b=0;$.each(a.res,function(a,c){function f(a){var b=a[0].geometry.location,d={map:map,position:b,title:c.username},e=new google.maps.Marker(d);e.setIcon(g+"asset/img/marker2.png");var f={content:'<div class="thumbnail" style="padding: 0px;"><img src="'+g+"asset/img/user_avatar/"+c.avatar+'" alt="..." style="margin: 0 auto;"><div class="caption"><h3 id="nameUser">'+c.username+'</h3><p><a href="#" class="btn btn-default btn-block" role="button">ver perfil</a><a href="#" class="btn btn-primary btn-block" data-dismiss="modal"  role="button">Cerrar</a></p> </div></div>'};new google.maps.InfoWindow(f);google.maps.event.addListener(e,"click",function(){perfilUsuario(c),window.location.href="#cont"+c.wuorks_key});var i=lat+","+lon,j=c.address+", "+c.commune,k="",l="",m="";1==c.type?(m="Profesional",l="u"):(m="Empresa",l="c");var n=new google.maps.DistanceMatrixService;n.getDistanceMatrix({origins:[i],destinations:[j],travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC,avoidHighways:!1,avoidTolls:!1},function(a,b){b!=google.maps.DistanceMatrixStatus.OK?kms="":kms="<small class=''><i class='fa fa-map-marker'></i> a "+a.rows[0].elements[0].distance.text+" de ti.</small>".toString(),k+=kms;var d='<li class="topHover" id="cont'+c.wuorks_key+'"style="border-bottom:1px solid #eee;"><div class="media" style="margin-left:5px;padding:5px;padding-top:15px;margin-bottom: -10px;"> <div class="media-left"><a href="'+g+"wuokers/"+l+"/"+c.username+"/"+c.profession+"/"+c.key_profession+"?wk="+c.wuorks_key+'"><img class="media-object img-thumbnail thumbnail" src="'+g+"asset/img/user_avatar/"+c.avatar+'" alt="'+c.username+'" style="height:100px; max-width:100px;"> </a> </div> <div class="media-body"><a href="'+g+"wuokers/"+l+"/"+c.username+"/"+c.profession+"/"+c.key_profession+"?wk="+c.wuorks_key+'"><h4 class="media-heading username">'+c.username+"<small>/ "+m+"</small></h4></a>"+c.profession+".<br>"+k+'</div> <div class="media-left text-center text-info"><br/>&nbsp;<b class="username">'+c.rating+'</b> <br/>&nbsp;<i class="fa fa-star-o" aria-hidden="true"></i> <br/>&nbsp;<small>Calificación</small> </div></div></li>';$("#loadTop").addClass("hidden"),$("#topWuokers").append(d)})}var d={address:c.address+" "+c.commune},e=new google.maps.Geocoder;e.geocode(d,f),b++}),$("#ttUser").html(b+" wuokers cerca de ti <i class='fa fa-map-marker'></i>")}else $("#alert-search").removeClass("hidden"),$("#sinResultados").removeClass("hidden"),$("#loadTop").addClass("hidden"),$("#tops").removeClass("open")}})}function perfilUsuario(a){var b=$("#url_base").val(),c="";c=1==a.type?"u":"c",$("#userInfo").html('<div class="thumbnail" style="padding: 0px; border:0px; max-width:300px;"><img src="'+b+"asset/img/user_avatar/"+a.avatar+'" alt="Wuokers" style="margin: 0 auto;"><div class="caption text-center"><h3 id="nameUser" style="font-weight:300;">'+a.username+'<br/><small style="font-weight:300;">Profesión - '+a.profession+'<hr/></small></h3><p><form name="form-user" id="form-user" action="'+b+"wuokers/"+c+"/"+a.username+"/"+a.profession+"/"+a.key_profession+"?wk="+a.wuorks_key+'" method="POST" target="_blank"><input type="hidden" name="wuorks_key" id="wuorks_key" value="'+a.wuorks_key+'"><input type="hidden" name="key_profession" id="key_profession" value="'+a.key_profession+'"><button type="submit" name="verPerfil" style="width:47%;float:right;" class="btn btn-primary btn-block">Ver perfil</button></form><br/><a href="#" class="btn btn-default btn-block" data-dismiss="modal" style="width:47%;float:left;margin-top:-20px;" role="button">Cerrar</a></p> </div></div>'),$("#perfilUser").modal("show")}navigator.geolocation.getCurrentPosition(initialize,fn_error);var divSearchMap=document.getElementById("map-search"),map,lon="",lat="",miI="";


/*******************************************************************************
 * Nota*: Documento generado por wuorks.com, no se permite copia de un fragmento
 * del codigo o del todo.
 * v1.0.
 ******************************************************************************/
